# Merety 백엔드 API 명세서

## 개요

이 문서는 Merety 프론트엔드 프로젝트를 분석하여 필요한 백엔드 API를 정리한 명세서입니다.

---

## 1. 인증 (Authentication)

### 1.1 회원가입

```
POST /api/auth/signup
```

**Request Body:**

```json
{
  "name": "string",
  "email": "string",
  "password": "string",
  "password_confirm": "string"
}
```

**Response:**

```json
{
  "id": "uuid",
  "email": "string",
  "name": "string",
  "handle": "string",
  "role": "MEMBER",
  "status": "active",
  "created_at": "timestamp"
}
```

### 1.2 로그인

```
POST /api/auth/login
```

**Request Body:**

```json
{
  "email": "string",
  "password": "string"
}
```

**Response:**

```json
{
  "access_token": "string",
  "refresh_token": "string",
  "user": {
    "id": "uuid",
    "email": "string",
    "name": "string",
    "userImage": "string",
    "role": "SUPER_ADMIN | STUDY_MANAGER | MEMBER",
    "status": "active | inactive"
  }
}
```

### 1.3 로그아웃

```
POST /api/auth/logout
```

### 1.4 토큰 갱신

```
POST /api/auth/refresh
```

---

## 2. 사용자 (Users)

### 2.1 현재 사용자 정보 조회

```
GET /api/users/me
```

### 2.2 사용자 목록 조회 (관리자)

```
GET /api/users
```

**Query Parameters:**

- `page`: number (기본값: 1)
- `limit`: number (기본값: 10)
- `search`: string (이름 검색)
- `status`: "active" | "inactive"
- `role`: "SUPER_ADMIN" | "STUDY_MANAGER" | "MEMBER"

**Response:**

```json
{
  "data": [
    {
      "id": "uuid",
      "email": "string",
      "name": "string",
      "handle": "string",
      "userImage": "string",
      "role": "string",
      "status": "string",
      "created_at": "timestamp",
      "last_login_at": "timestamp"
    }
  ],
  "pagination": {
    "total": "number",
    "page": "number",
    "limit": "number",
    "total_pages": "number"
  }
}
```

### 2.3 사용자 상세 조회

```
GET /api/users/:userId
```

### 2.4 사용자 정보 수정 (관리자)

```
PUT /api/users/:userId
```

**Request Body:**

```json
{
  "name": "string",
  "email": "string",
  "password": "string (optional)",
  "userImage": "string",
  "role": "SUPER_ADMIN | STUDY_MANAGER | MEMBER",
  "status": "active | inactive"
}
```

### 2.5 사용자 삭제 (관리자)

```
DELETE /api/users/:userId
```

---

## 3. 스터디 (Studies)

### 3.1 스터디 목록 조회

```
GET /api/studies
```

**Query Parameters:**

- `page`: number
- `limit`: number
- `status`: "active" | "archived"
- `type`: "RED" | "WEB"

**Response:**

```json
{
  "data": [
    {
      "id": "uuid",
      "name": "string",
      "type": "RED | WEB",
      "slug": "string",
      "status": "active | archived",
      "created_by": "uuid",
      "created_at": "timestamp",
      "updated_at": "timestamp",
      "member_count": "number"
    }
  ],
  "pagination": {...}
}
```

### 3.2 스터디 상세 조회

```
GET /api/studies/:studyId
```

**Response:**

```json
{
  "id": "uuid",
  "name": "string",
  "type": "RED | WEB",
  "slug": "string",
  "status": "active | archived",
  "created_by": "uuid",
  "created_at": "timestamp",
  "updated_at": "timestamp",
  "overview": {
    "description": "string (markdown)",
    "manager_list": [
      {
        "id": "uuid",
        "name": "string",
        "role": "manager | member",
        "profileImage": "string"
      }
    ]
  },
  "sessions": [...],
  "members": [...],
  "wil": [...],
  "archives": [...]
}
```

### 3.3 스터디 생성 (관리자)

```
POST /api/studies
```

**Request Body:**

```json
{
  "name": "string",
  "type": "RED | WEB",
  "slug": "string",
  "overview": {
    "description": "string",
    "manager_list": ["uuid"]
  }
}
```

### 3.4 스터디 수정 (관리자)

```
PUT /api/studies/:studyId
```

**Request Body:**

```json
{
  "name": "string",
  "type": "RED | WEB",
  "slug": "string",
  "status": "active | archived",
  "overview": {
    "description": "string",
    "manager_list": ["uuid"]
  }
}
```

### 3.5 스터디 삭제 (관리자)

```
DELETE /api/studies/:studyId
```

---

## 4. 스터디 세션 (Sessions)

### 4.1 세션 목록 조회

```
GET /api/studies/:studyId/sessions
```

**Query Parameters:**

- `page`: number
- `limit`: number
- `status`: "active" | "archived"

**Response:**

```json
{
  "data": [
    {
      "id": "uuid",
      "study_id": "uuid",
      "session_no": "number",
      "round": "number",
      "title": "string",
      "status": "active | archived",
      "scheduled_at": "date",
      "created_at": "timestamp",
      "createUser": {
        "name": "string",
        "userImage": "string"
      }
    }
  ],
  "pagination": {...}
}
```

### 4.2 세션 상세 조회

```
GET /api/studies/:studyId/sessions/:sessionId
```

**Response:**

```json
{
  "id": "uuid",
  "study_id": "uuid",
  "session_no": "number",
  "round": "number",
  "title": "string",
  "status": "string",
  "scheduled_at": "date",
  "content_md": "string (markdown)",
  "created_at": "timestamp",
  "updated_at": "timestamp",
  "createUser": {...},
  "data": {
    "materials": ["string"]
  }
}
```

### 4.3 세션 생성

```
POST /api/studies/:studyId/sessions
```

**Request Body:**

```json
{
  "title": "string",
  "scheduled_at": "date",
  "content_md": "string",
  "data": {
    "materials": ["string"]
  }
}
```

### 4.4 세션 수정

```
PUT /api/studies/:studyId/sessions/:sessionId
```

### 4.5 세션 삭제

```
DELETE /api/studies/:studyId/sessions/:sessionId
```

---

## 5. 스터디 멤버 (Study Members)

### 5.1 멤버 목록 조회

```
GET /api/studies/:studyId/members
```

**Query Parameters:**

- `page`: number
- `limit`: number
- `role`: "MANAGER" | "MEMBER"

**Response:**

```json
{
  "data": [
    {
      "id": "uuid",
      "user_id": "uuid",
      "name": "string",
      "email": "string",
      "userImage": "string",
      "role": "MANAGER | MEMBER",
      "status": "active | inactive",
      "joined_at": "timestamp"
    }
  ],
  "pagination": {...}
}
```

### 5.2 멤버 추가

```
POST /api/studies/:studyId/members
```

**Request Body:**

```json
{
  "user_id": "uuid",
  "role": "MANAGER | MEMBER"
}
```

### 5.3 멤버 역할 수정

```
PUT /api/studies/:studyId/members/:memberId
```

### 5.4 멤버 삭제

```
DELETE /api/studies/:studyId/members/:memberId
```

---

## 6. WIL (Weekly I Learned)

### 6.1 WIL 목록 조회

```
GET /api/studies/:studyId/wil
```

**Query Parameters:**

- `page`: number
- `limit`: number
- `author_id`: uuid

**Response:**

```json
{
  "data": [
    {
      "id": "uuid",
      "study_id": "uuid",
      "author_id": "uuid",
      "title": "string",
      "tags": ["string"],
      "created_at": "timestamp",
      "createUser": {
        "name": "string",
        "userImage": "string"
      }
    }
  ],
  "pagination": {...}
}
```

### 6.2 WIL 상세 조회

```
GET /api/studies/:studyId/wil/:wilId
```

**Response:**

```json
{
  "id": "uuid",
  "study_id": "uuid",
  "author_id": "uuid",
  "title": "string",
  "content_md": "string (markdown)",
  "tags": ["string"],
  "created_at": "timestamp",
  "updated_at": "timestamp",
  "createUser": {...}
}
```

### 6.3 WIL 작성

```
POST /api/studies/:studyId/wil
```

**Request Body:**

```json
{
  "title": "string",
  "content_md": "string (markdown)",
  "tags": ["string"]
}
```

### 6.4 WIL 수정

```
PUT /api/studies/:studyId/wil/:wilId
```

### 6.5 WIL 삭제

```
DELETE /api/studies/:studyId/wil/:wilId
```

---

## 7. 아카이브 (Archives)

### 7.1 아카이브 목록 조회

```
GET /api/studies/:studyId/archives
```

**Query Parameters:**

- `page`: number
- `limit`: number
- `category`: "DOC" | "SLIDE" | "CODE" | "LINK" | "ETC"
- `type`: "FILE" | "LINK"

**Response:**

```json
{
  "data": [
    {
      "id": "uuid",
      "study_id": "uuid",
      "uploader_id": "uuid",
      "type": "FILE | LINK",
      "title": "string",
      "category": "DOC | SLIDE | CODE | LINK | ETC",
      "url": "string (for LINK type)",
      "storage_key": "string (for FILE type)",
      "created_at": "timestamp"
    }
  ],
  "pagination": {...}
}
```

### 7.2 아카이브 파일 업로드

```
POST /api/studies/:studyId/archives/upload
```

**Request:** `multipart/form-data`

- `file`: File
- `title`: string
- `category`: "DOC" | "SLIDE" | "CODE" | "ETC"

### 7.3 아카이브 링크 추가

```
POST /api/studies/:studyId/archives/link
```

**Request Body:**

```json
{
  "title": "string",
  "url": "string"
}
```

### 7.4 아카이브 삭제

```
DELETE /api/studies/:studyId/archives/:archiveId
```

### 7.5 아카이브 파일 다운로드

```
GET /api/studies/:studyId/archives/:archiveId/download
```

---

## 8. 팀 (Team)

### 8.1 팀 멤버 목록 조회

```
GET /api/team/members
```

**Query Parameters:**

- `page`: number
- `limit`: number
- `search`: string
- `role`: "SUPER_ADMIN" | "STUDY_MANAGER" | "MEMBER"
- `status`: "active" | "inactive"

**Response:**

```json
{
  "data": [
    {
      "user": {
        "id": "uuid",
        "email": "string",
        "name": "string",
        "handle": "string",
        "userImage": "string",
        "role": "string",
        "status": "string",
        "created_at": "timestamp",
        "last_login_at": "timestamp"
      },
      "joined_at": "timestamp",
      "role": "string"
    }
  ],
  "pagination": {...}
}
```

### 8.2 팀 멤버 상세 조회

```
GET /api/team/members/:memberId
```

---

## 9. 공지사항 (Notices)

### 9.1 공지사항 목록 조회

```
GET /api/team/notices
```

**Query Parameters:**

- `page`: number
- `limit`: number
- `search`: string

**Response:**

```json
{
  "data": [
    {
      "id": "uuid",
      "title": "string",
      "created_by": "uuid",
      "created_at": "timestamp",
      "createUser": {
        "name": "string",
        "userImage": "string"
      }
    }
  ],
  "pagination": {...}
}
```

### 9.2 공지사항 상세 조회

```
GET /api/team/notices/:noticeId
```

**Response:**

```json
{
  "id": "uuid",
  "title": "string",
  "content_md": "string (markdown)",
  "created_by": "uuid",
  "created_at": "timestamp",
  "updated_at": "timestamp",
  "createUser": {...}
}
```

### 9.3 공지사항 작성 (관리자)

```
POST /api/team/notices
```

**Request Body:**

```json
{
  "title": "string",
  "content_md": "string (markdown)"
}
```

### 9.4 공지사항 수정 (관리자)

```
PUT /api/team/notices/:noticeId
```

### 9.5 공지사항 삭제 (관리자)

```
DELETE /api/team/notices/:noticeId
```

---

## 10. TIL (Today I Learned)

### 10.1 TIL 목록 조회

```
GET /api/team/tils
```

**Query Parameters:**

- `page`: number
- `limit`: number
- `search`: string
- `author_id`: uuid
- `study_id`: uuid (optional)

**Response:**

```json
{
  "data": [
    {
      "id": "uuid",
      "study_id": "uuid",
      "author_id": "uuid",
      "author_name": "string",
      "author_image": "string",
      "title": "string",
      "tags": ["string"],
      "created_at": "timestamp"
    }
  ],
  "pagination": {...}
}
```

### 10.2 TIL 상세 조회

```
GET /api/team/tils/:tilId
```

### 10.3 TIL 작성

```
POST /api/team/tils
```

**Request Body:**

```json
{
  "study_id": "uuid (optional)",
  "title": "string",
  "content_md": "string (markdown)",
  "tags": ["string"]
}
```

### 10.4 TIL 수정

```
PUT /api/team/tils/:tilId
```

### 10.5 TIL 삭제

```
DELETE /api/team/tils/:tilId
```

### 10.6 내 TIL 통계 조회

```
GET /api/team/tils/stats/me
```

**Response:**

```json
{
  "total_count": "number",
  "monthly_count": "number"
}
```

---

## 11. 역할 (Roles)

### 11.1 역할 목록 조회

```
GET /api/team/roles
```

**Response:**

```json
{
  "data": [
    {
      "role": "SUPER_ADMIN | STUDY_MANAGER | MEMBER",
      "description": "string"
    }
  ]
}
```

---

## 12. 대시보드 (Dashboard)

### 12.1 메인 대시보드 데이터 조회

```
GET /api/dashboard
```

**Response:**

```json
{
  "studies": [
    {
      "id": "uuid",
      "title": "string",
      "slug": "string",
      "type": "RED | WEB",
      "member_count": "number",
      "member_images": ["string"]
    }
  ],
  "til_stats": {
    "total_count": "number",
    "monthly_count": "number",
    "recent_tils": [
      {
        "id": "uuid",
        "title": "string",
        "date": "string"
      }
    ]
  },
  "recent_activities": [
    {
      "id": "uuid",
      "title": "string",
      "time": "string"
    }
  ],
  "calendar_events": [
    {
      "id": "uuid",
      "title": "string",
      "date": "date",
      "type": "session | deadline | event"
    }
  ]
}
```

---

## 13. 일정 (Calendar/Events)

### 13.1 일정 목록 조회

```
GET /api/events
```

**Query Parameters:**

- `start_date`: date
- `end_date`: date
- `study_id`: uuid (optional)

**Response:**

```json
{
  "data": [
    {
      "id": "uuid",
      "title": "string",
      "description": "string",
      "start_date": "timestamp",
      "end_date": "timestamp",
      "type": "session | deadline | event",
      "study_id": "uuid (optional)"
    }
  ]
}
```

### 13.2 일정 생성

```
POST /api/events
```

### 13.3 일정 수정

```
PUT /api/events/:eventId
```

### 13.4 일정 삭제

```
DELETE /api/events/:eventId
```

---

## 14. 파일 업로드 (File Upload)

### 14.1 프로필 이미지 업로드

```
POST /api/upload/profile
```

**Request:** `multipart/form-data`

- `file`: Image File

**Response:**

```json
{
  "url": "string (uploaded image URL)"
}
```

### 14.2 일반 파일 업로드

```
POST /api/upload/file
```

---

## 데이터 타입 참고

### UserRole

```typescript
enum UserRole {
  SUPER_ADMIN = "SUPER_ADMIN",
  STUDY_MANAGER = "STUDY_MANAGER",
  MEMBER = "MEMBER",
}
```

### UserStatus

```typescript
enum UserStatus {
  ACTIVE = "active",
  INACTIVE = "inactive",
}
```

### StudyType

```typescript
enum StudyType {
  RED = "RED",
  WEB = "WEB",
}
```

### StudyStatus

```typescript
enum StudyStatus {
  ACTIVE = "active",
  ARCHIVED = "archived",
}
```

### ArchiveType

```typescript
enum ArchiveType {
  FILE = "FILE",
  LINK = "LINK",
}
```

### ArchiveCategory

```typescript
enum ArchiveCategory {
  SLIDE = "SLIDE",
  DOC = "DOC",
  CODE = "CODE",
  LINK = "LINK",
  ETC = "ETC",
}
```

---

## 공통 응답 형식

### 성공 응답

```json
{
  "success": true,
  "data": {...},
  "message": "string (optional)"
}
```

### 에러 응답

```json
{
  "success": false,
  "error": {
    "code": "string",
    "message": "string"
  }
}
```

### 페이지네이션

```json
{
  "pagination": {
    "total": "number",
    "page": "number",
    "limit": "number",
    "total_pages": "number",
    "has_next": "boolean",
    "has_prev": "boolean"
  }
}
```

---

## 인증 헤더

모든 보호된 엔드포인트는 다음 헤더가 필요합니다:

```
Authorization: Bearer <access_token>
```

---

## 권한 요약

| 기능             | SUPER_ADMIN | STUDY_MANAGER    | MEMBER      |
| ---------------- | ----------- | ---------------- | ----------- |
| 사용자 관리      | ✅          | ❌               | ❌          |
| 스터디 생성/삭제 | ✅          | ❌               | ❌          |
| 스터디 수정      | ✅          | ✅ (담당 스터디) | ❌          |
| 세션 관리        | ✅          | ✅ (담당 스터디) | ❌          |
| 멤버 관리        | ✅          | ✅ (담당 스터디) | ❌          |
| WIL 작성         | ✅          | ✅               | ✅          |
| WIL 수정/삭제    | ✅          | ✅               | ✅ (본인만) |
| TIL 작성         | ✅          | ✅               | ✅          |
| TIL 수정/삭제    | ✅          | ✅               | ✅ (본인만) |
| 공지사항 관리    | ✅          | ✅               | ❌          |
| 아카이브 업로드  | ✅          | ✅               | ✅          |
| 아카이브 삭제    | ✅          | ✅               | ✅ (본인만) |
