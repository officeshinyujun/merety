# ğŸš€ Merety ë°±ì—”ë“œ API ìµœì¢… ëª…ì„¸ì„œ v1.0

> ì´ ë¬¸ì„œëŠ” ê¸°ì¡´ ê¸°íšì„œì™€ í”„ë¡ íŠ¸ì—”ë“œ íƒ€ì… ì •ì˜ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì‘ì„±ëœ ìµœì¢… ë°±ì—”ë“œ API ëª…ì„¸ì„œì…ë‹ˆë‹¤.

---

## ğŸ“‹ ëª©ì°¨

1. [ê°œìš”](#1-ê°œìš”)
2. [ì¸ì¦ ë° ì ‘ê·¼ ì œì–´](#2-ì¸ì¦-ë°-ì ‘ê·¼-ì œì–´)
3. [ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ](#3-ë°ì´í„°ë² ì´ìŠ¤-ìŠ¤í‚¤ë§ˆ)
4. [íƒ€ì… ì •ì˜](#4-íƒ€ì…-ì •ì˜)
5. [API ì—”ë“œí¬ì¸íŠ¸](#5-api-ì—”ë“œí¬ì¸íŠ¸)
6. [ê¶Œí•œ ë§¤íŠ¸ë¦­ìŠ¤](#6-ê¶Œí•œ-ë§¤íŠ¸ë¦­ìŠ¤)
7. [ê³µí†µ ê·œê²©](#7-ê³µí†µ-ê·œê²©)

---

## 1. ê°œìš”

### 1.1 ëª©ì 

- 404BNF íŒ€ ë‚´ë¶€ ìŠ¤í„°ë”” ìš´ì˜ì„ ì²´ê³„ì ìœ¼ë¡œ ê´€ë¦¬í•˜ëŠ” í¬í„¸ ì‹œìŠ¤í…œ
- ìŠ¤í„°ë””ëŠ” **ì´ê´€ë¦¬ì(SUPER_ADMIN)** ì¤‘ì‹¬ìœ¼ë¡œ ìƒì„±/í†µì œ
- ìš´ì˜ì€ **ìŠ¤í„°ë”” ë‹´ë‹¹ì(STUDY_MANAGER)**ì—ê²Œ ìœ„ì„
- íŒ€ì›ì€ ìŠ¤í„°ë”” ë‚´ì—ì„œ **TIL/WIL ê¸°ë¡**, ê°œì¸ í™œë™ì€ Dashboardì—ì„œ í™•ì¸

### 1.2 MVP ë²”ìœ„

- âœ… ì¸ì¦/ê³„ì • ê´€ë¦¬ (ê´€ë¦¬ì ê³„ì • ìƒì„± + ì„ì‹œ ë¹„ë°€ë²ˆí˜¸ + ì²« ë¡œê·¸ì¸ ë¹„ë²ˆ ë³€ê²½ ê°•ì œ)
- âœ… ë¡œê·¸ì¸ í•„ìˆ˜ (ì „ í˜ì´ì§€ ì ‘ê·¼ ì œì–´)
- âœ… Study (Red Team Study / Web Study)
- âœ… ìŠ¤í„°ë”” ë‚´ë¶€: Overview / Sessions / Members / TIL(WIL) / Archive
- âœ… Team: Notice / Members / Roles & Contribution
- âœ… Admin: User Management / Study Management / Metrics

### 1.3 ì œì™¸ ë²”ìœ„

- âŒ ëŒ“ê¸€ ì‹œìŠ¤í…œ
- âŒ ì™¸ë¶€ ê³µê°œ í˜ì´ì§€
- âŒ ê²°ì œ/ìˆ˜ìµí™” ê¸°ëŠ¥

---

## 2. ì¸ì¦ ë° ì ‘ê·¼ ì œì–´

### 2.1 ì¸ì¦ ì •ì±…

| í•­ëª©               | ì •ì±…                               |
| ------------------ | ---------------------------------- |
| ì¸ì¦ ë°©ì‹          | JWT (Access Token + Refresh Token) |
| Access Token ì €ì¥  | ë©”ëª¨ë¦¬ ë˜ëŠ” localStorage           |
| Refresh Token ì €ì¥ | httpOnly ì¿ í‚¤ (ê¶Œì¥)               |
| Access Token ë§Œë£Œ  | 15ë¶„ ~ 1ì‹œê°„                       |
| Refresh Token ë§Œë£Œ | 7ì¼ ~ 30ì¼                         |
| ë¹„ë°€ë²ˆí˜¸ í•´ì‹œ      | Argon2 ë˜ëŠ” bcrypt                 |

### 2.2 ì ‘ê·¼ ì œì–´

- `/api/auth/*` ê²½ë¡œë§Œ ì¸ì¦ ì˜ˆì™¸
- ê·¸ ì™¸ ëª¨ë“  APIëŠ” ë¯¸ì¸ì¦ ì‹œ **401 Unauthorized**
- ê¶Œí•œ ë¶€ì¡± ì‹œ **403 Forbidden**

### 2.3 ê³„ì • ìƒíƒœ

```typescript
enum UserStatus {
  ACTIVE = "active", // ì •ìƒ
  INACTIVE = "inactive", // ë¹„í™œì„± (ë¡œê·¸ì¸ ë¶ˆê°€)
}
```

### 2.4 ì²« ë¡œê·¸ì¸ ë¹„ë°€ë²ˆí˜¸ ë³€ê²½

- `must_change_password = true`ì¸ ê²½ìš° ë¡œê·¸ì¸ ì„±ê³µ í›„ ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ ê°•ì œ
- ë³€ê²½ ì™„ë£Œ í›„ `must_change_password = false`ë¡œ ì—…ë°ì´íŠ¸

---

## 3. ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ

### 3.1 users

```sql
CREATE TABLE users (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  email VARCHAR(255) UNIQUE NOT NULL,
  password_hash VARCHAR(255) NOT NULL,
  name VARCHAR(100),
  handle VARCHAR(50) UNIQUE NOT NULL,
  user_image VARCHAR(500),
  role user_role NOT NULL DEFAULT 'MEMBER',
  status user_status NOT NULL DEFAULT 'active',
  must_change_password BOOLEAN DEFAULT TRUE,
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW(),
  last_login_at TIMESTAMP
);

CREATE TYPE user_role AS ENUM ('SUPER_ADMIN', 'STUDY_MANAGER', 'MEMBER');
CREATE TYPE user_status AS ENUM ('active', 'inactive');
```

### 3.2 studies

```sql
CREATE TABLE studies (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  name VARCHAR(200) NOT NULL,
  type study_type NOT NULL,
  slug TEXT,
  status study_status NOT NULL DEFAULT 'active',
  created_by UUID REFERENCES users(id),
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW()
);

CREATE TYPE study_type AS ENUM ('RED', 'WEB');
CREATE TYPE study_status AS ENUM ('active', 'archived');
```

### 3.3 study_overview

```sql
CREATE TABLE study_overview (
  study_id UUID PRIMARY KEY REFERENCES studies(id) ON DELETE CASCADE,
  description TEXT,
  updated_by UUID REFERENCES users(id),
  updated_at TIMESTAMP DEFAULT NOW()
);
```

### 3.4 study_memberships

```sql
CREATE TABLE study_memberships (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  study_id UUID REFERENCES studies(id) ON DELETE CASCADE,
  user_id UUID REFERENCES users(id) ON DELETE CASCADE,
  member_role study_member_role NOT NULL DEFAULT 'MEMBER',
  joined_at TIMESTAMP DEFAULT NOW(),
  UNIQUE(study_id, user_id)
);

CREATE TYPE study_member_role AS ENUM ('MANAGER', 'MEMBER');
```

### 3.5 sessions

```sql
CREATE TABLE sessions (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  study_id UUID REFERENCES studies(id) ON DELETE CASCADE,
  session_no INTEGER NOT NULL,
  round INTEGER DEFAULT 1,
  title VARCHAR(300) NOT NULL,
  status session_status DEFAULT 'active',
  scheduled_at DATE,
  content_md TEXT,
  created_by UUID REFERENCES users(id),
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW(),
  data JSONB,
  UNIQUE(study_id, session_no)
);

CREATE TYPE session_status AS ENUM ('active', 'archived');
```

### 3.6 attendance

```sql
CREATE TABLE attendance (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  session_id UUID REFERENCES sessions(id) ON DELETE CASCADE,
  user_id UUID REFERENCES users(id) ON DELETE CASCADE,
  status attendance_status DEFAULT 'UNKNOWN',
  memo TEXT,
  updated_by UUID REFERENCES users(id),
  updated_at TIMESTAMP DEFAULT NOW(),
  UNIQUE(session_id, user_id)
);

CREATE TYPE attendance_status AS ENUM ('PRESENT', 'LATE', 'ABSENT', 'UNKNOWN');
```

### 3.7 til_posts (WIL í¬í•¨)

```sql
CREATE TABLE til_posts (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  study_id UUID REFERENCES studies(id) ON DELETE CASCADE,
  author_id UUID REFERENCES users(id) ON DELETE CASCADE,
  title VARCHAR(500) NOT NULL,
  content_md TEXT,
  tags TEXT[],
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW(),
  is_deleted BOOLEAN DEFAULT FALSE
);
```

### 3.8 archives

```sql
CREATE TABLE archives (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  study_id UUID REFERENCES studies(id) ON DELETE CASCADE,
  uploader_id UUID REFERENCES users(id),
  type archive_type NOT NULL,
  title VARCHAR(300) NOT NULL,
  url VARCHAR(1000),
  storage_key VARCHAR(500),
  category archive_category NOT NULL,
  created_at TIMESTAMP DEFAULT NOW(),
  is_deleted BOOLEAN DEFAULT FALSE
);

CREATE TYPE archive_type AS ENUM ('FILE', 'LINK');
CREATE TYPE archive_category AS ENUM ('SLIDE', 'DOC', 'CODE', 'LINK', 'ETC');
```

### 3.9 notices

```sql
CREATE TABLE notices (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  title VARCHAR(500) NOT NULL,
  content_md TEXT,
  created_by UUID REFERENCES users(id),
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW(),
  is_deleted BOOLEAN DEFAULT FALSE
);
```

### 3.10 activity_logs

```sql
CREATE TABLE activity_logs (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID REFERENCES users(id),
  action_type action_type NOT NULL,
  entity_type entity_type NOT NULL,
  entity_id UUID,
  meta JSONB,
  created_at TIMESTAMP DEFAULT NOW()
);

CREATE TYPE action_type AS ENUM ('CREATE', 'UPDATE', 'DELETE', 'LOGIN', 'LOGOUT');
CREATE TYPE entity_type AS ENUM ('USER', 'STUDY', 'SESSION', 'TIL_POST', 'ARCHIVE', 'NOTICE', 'ATTENDANCE');
```

---

## 4. íƒ€ì… ì •ì˜

> í”„ë¡ íŠ¸ì—”ë“œ `src/types/`ì™€ ë™ì¼í•œ íƒ€ì… ì •ì˜ì…ë‹ˆë‹¤.

### 4.1 ê³µí†µ íƒ€ì…

```typescript
type UUID = string;
type Timestamp = string; // ISO 8601 format
```

### 4.2 User

```typescript
enum UserRole {
  SUPER_ADMIN = "SUPER_ADMIN",
  STUDY_MANAGER = "STUDY_MANAGER",
  MEMBER = "MEMBER",
}

enum UserStatus {
  ACTIVE = "active",
  INACTIVE = "inactive",
}

interface User {
  id: UUID;
  email: string;
  password_hash: string;
  userImage: string;
  name?: string | null;
  handle: string;
  role: UserRole;
  status: UserStatus;
  must_change_password: boolean;
  created_at: Timestamp;
  updated_at: Timestamp;
  last_login_at?: Timestamp | null;
}
```

### 4.3 Study

```typescript
enum StudyType {
  RED = "RED",
  WEB = "WEB",
}

enum StudyStatus {
  ACTIVE = "active",
  ARCHIVED = "archived",
}

enum StudyMemberRole {
  MANAGER = "MANAGER",
  MEMBER = "MEMBER",
}

interface Study {
  id: UUID;
  name: string;
  type: StudyType;
  slug: string;
  status: StudyStatus;
  created_by: UUID;
  created_at: Timestamp;
  updated_at: Timestamp;
  overview?: StudyOverview;
}

interface StudyOverview {
  description: string;
  manager_list: ManagerInfo[];
}

interface ManagerInfo {
  id: UUID;
  name: string;
  role: string;
  profileImage: string;
}

interface StudyMembership {
  id: UUID;
  study_id: UUID;
  user_id: UUID;
  member_role: StudyMemberRole;
  joined_at: Timestamp;
}
```

### 4.4 Session

```typescript
interface Session {
  id: UUID;
  study_id: UUID;
  session_no: number;
  round: number;
  title: string;
  status: "active" | "archived";
  scheduled_at: string;
  content_md: string;
  created_by: UUID;
  created_at: Timestamp;
  updated_at: Timestamp;
  data?: {
    materials?: string[];
  };
  createUser?: {
    name: string;
    userImage: string;
  };
}
```

### 4.5 Attendance

```typescript
enum AttendanceStatus {
  PRESENT = "PRESENT",
  LATE = "LATE",
  ABSENT = "ABSENT",
  UNKNOWN = "UNKNOWN",
}

interface Attendance {
  id: UUID;
  session_id: UUID;
  user_id: UUID;
  status: AttendanceStatus;
  memo?: string | null;
  updated_by: UUID;
  updated_at: Timestamp;
}
```

### 4.6 TilPost (WIL)

```typescript
interface TilPost {
  id: UUID;
  study_id: UUID;
  author_id: UUID;
  author_name: string;
  author_image: string;
  title: string;
  content_md: string;
  tags: string[];
  created_at: Timestamp;
  updated_at: Timestamp;
  is_deleted: boolean;
  createUser?: {
    name: string;
    userImage: string;
  };
}
```

### 4.7 Archive

```typescript
enum ArchiveType {
  FILE = "FILE",
  LINK = "LINK",
}

enum ArchiveCategory {
  SLIDE = "SLIDE",
  DOC = "DOC",
  CODE = "CODE",
  LINK = "LINK",
  ETC = "ETC",
}

interface Archive {
  id: UUID;
  study_id: UUID;
  uploader_id: UUID;
  type: ArchiveType;
  title: string;
  url?: string;
  storage_key?: string;
  category: ArchiveCategory;
  created_at: Timestamp;
  is_deleted: boolean;
}
```

### 4.8 Notice

```typescript
interface Notice {
  id: UUID;
  title: string;
  content_md: string;
  created_by: UUID;
  created_at: Timestamp;
  updated_at: Timestamp;
  is_deleted: boolean;
  createUser?: {
    name: string;
    userImage: string;
  };
}
```

### 4.9 ActivityLog

```typescript
enum ActionType {
  CREATE = "CREATE",
  UPDATE = "UPDATE",
  DELETE = "DELETE",
  LOGIN = "LOGIN",
  LOGOUT = "LOGOUT",
}

enum EntityType {
  USER = "USER",
  STUDY = "STUDY",
  SESSION = "SESSION",
  TIL_POST = "TIL_POST",
  ARCHIVE = "ARCHIVE",
  NOTICE = "NOTICE",
  ATTENDANCE = "ATTENDANCE",
}

interface ActivityLog {
  id: UUID;
  user_id: UUID;
  action_type: ActionType;
  entity_type: EntityType;
  entity_id: UUID;
  meta: Record<string, unknown>;
  created_at: Timestamp;
}
```

---

## 5. API ì—”ë“œí¬ì¸íŠ¸

### 5.1 ì¸ì¦ (Auth)

#### POST /api/auth/login

ë¡œê·¸ì¸

```typescript
// Request
{
  email: string;
  password: string;
}

// Response (ì„±ê³µ)
{
  access_token: string;
  refresh_token: string;
  user: User;
  must_change_password: boolean;
}

// ì—ëŸ¬
// 401: ì´ë©”ì¼ ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ ì˜¤ë¥˜
// 403: ë¹„í™œì„± ê³„ì •
```

#### POST /api/auth/logout

ë¡œê·¸ì•„ì›ƒ (Refresh Token ë¬´íš¨í™”)

#### POST /api/auth/refresh

Access Token ê°±ì‹ 

```typescript
// Request (ì¿ í‚¤ì—ì„œ refresh_token ìë™ ì „ì†¡)

// Response
{
  access_token: string;
}
```

#### GET /api/auth/me

í˜„ì¬ ë¡œê·¸ì¸ ì‚¬ìš©ì ì •ë³´

```typescript
// Response
{
  user: User;
}
```

#### POST /api/auth/change-password

ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ (ì²« ë¡œê·¸ì¸ ê°•ì œ ë³€ê²½ í¬í•¨)

```typescript
// Request
{
  current_password?: string;  // ì²« ë¡œê·¸ì¸ ì‹œ ì„ íƒ
  new_password: string;
  confirm_password: string;
}

// Response
{
  success: true;
  message: "ë¹„ë°€ë²ˆí˜¸ê°€ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.";
}
```

---

### 5.2 ê´€ë¦¬ì - ìœ ì € ê´€ë¦¬ (Admin Users)

#### GET /api/admin/users

ìœ ì € ëª©ë¡ ì¡°íšŒ (SUPER_ADMIN ì „ìš©)

```typescript
// Query Parameters
{
  page?: number;          // ê¸°ë³¸ê°’: 1
  limit?: number;         // ê¸°ë³¸ê°’: 10
  search?: string;        // ì´ë¦„/ì´ë©”ì¼ ê²€ìƒ‰
  role?: UserRole;
  status?: UserStatus;
}

// Response
{
  data: User[];
  pagination: Pagination;
}
```

#### POST /api/admin/users

ìœ ì € ìƒì„± (SUPER_ADMIN ì „ìš©)

```typescript
// Request
{
  email: string;
  handle: string;
  name?: string;
  role?: UserRole;  // ê¸°ë³¸ê°’: MEMBER
}

// Response
{
  user: User;
  temporary_password: string;  // 1íšŒë§Œ í‘œì‹œ
}
```

#### PATCH /api/admin/users/:userId

ìœ ì € ì •ë³´ ìˆ˜ì • (SUPER_ADMIN ì „ìš©)

```typescript
// Request
{
  name?: string;
  role?: UserRole;
  status?: UserStatus;
  userImage?: string;
}

// Response
{
  user: User;
}
```

#### POST /api/admin/users/:userId/reset-password

ë¹„ë°€ë²ˆí˜¸ ì´ˆê¸°í™” (SUPER_ADMIN ì „ìš©)

```typescript
// Response
{
  temporary_password: string; // 1íšŒë§Œ í‘œì‹œ
  must_change_password: true;
}
```

---

### 5.3 ìŠ¤í„°ë”” (Studies)

#### GET /api/studies

ìŠ¤í„°ë”” ëª©ë¡ ì¡°íšŒ

```typescript
// Query Parameters
{
  status?: StudyStatus;
  type?: StudyType;
}

// Response
{
  data: Study[];
}
```

#### GET /api/studies/:studyId

ìŠ¤í„°ë”” ìƒì„¸ ì¡°íšŒ

```typescript
// Response
{
  ...Study;
  overview: StudyOverview;
  sessions: Session[];
  members: StudyMember[];
  wil: TilPost[];
  archives: Archive[];
}
```

#### POST /api/studies

ìŠ¤í„°ë”” ìƒì„± (SUPER_ADMIN ì „ìš©)

```typescript
// Request
{
  name: string;
  type: StudyType;
  slug?: string;
  overview?: {
    description: string;
  };
  manager_ids?: UUID[];  // ë‹´ë‹¹ì ì§€ì •
}

// Response
{
  study: Study;
}
```

#### PATCH /api/studies/:studyId

ìŠ¤í„°ë”” ìˆ˜ì • (SUPER_ADMIN ì „ìš©)

```typescript
// Request
{
  name?: string;
  type?: StudyType;
  slug?: string;
  status?: StudyStatus;
}

// Response
{
  study: Study;
}
```

#### DELETE /api/studies/:studyId

ìŠ¤í„°ë”” ì‚­ì œ (SUPER_ADMIN ì „ìš©, Soft Delete ê¶Œì¥)

---

### 5.4 ìŠ¤í„°ë”” Overview

#### GET /api/studies/:studyId/overview

Overview ì¡°íšŒ

#### PATCH /api/studies/:studyId/overview

Overview ìˆ˜ì • (SUPER_ADMIN ë˜ëŠ” í•´ë‹¹ STUDY_MANAGER)

```typescript
// Request
{
  description: string; // Markdown
}
```

---

### 5.5 ìŠ¤í„°ë”” ë©¤ë²„ (Study Members)

#### GET /api/studies/:studyId/members

ë©¤ë²„ ëª©ë¡ ì¡°íšŒ

```typescript
// Response
{
  data: {
    id: UUID;
    user: User;
    member_role: StudyMemberRole;
    joined_at: Timestamp;
  }
  [];
}
```

#### POST /api/studies/:studyId/members

ë©¤ë²„ ì¶”ê°€ (SUPER_ADMIN ì „ìš©)

```typescript
// Request
{
  user_id: UUID;
  member_role?: StudyMemberRole;  // ê¸°ë³¸ê°’: MEMBER
}
```

#### PATCH /api/studies/:studyId/members/:userId

ë©¤ë²„ ì—­í•  ë³€ê²½ (SUPER_ADMIN ì „ìš©)

```typescript
// Request
{
  member_role: StudyMemberRole; // MANAGER ì§€ì •/í•´ì œ
}
```

#### DELETE /api/studies/:studyId/members/:userId

ë©¤ë²„ ì œê±° (SUPER_ADMIN ì „ìš©)

---

### 5.6 ì„¸ì…˜ (Sessions)

#### GET /api/studies/:studyId/sessions

ì„¸ì…˜ ëª©ë¡ ì¡°íšŒ

```typescript
// Query Parameters
{
  status?: "active" | "archived";
}

// Response
{
  data: Session[];
}
```

#### GET /api/sessions/:sessionId

ì„¸ì…˜ ìƒì„¸ ì¡°íšŒ

```typescript
// Response
{
  ...Session;
  attendance: Attendance[];
}
```

#### POST /api/studies/:studyId/sessions

ì„¸ì…˜ ìƒì„± (SUPER_ADMIN ë˜ëŠ” í•´ë‹¹ STUDY_MANAGER)

```typescript
// Request
{
  title: string;
  scheduled_at: string;  // YYYY-MM-DD
  content_md?: string;
  data?: {
    materials?: string[];
  };
}
```

#### PATCH /api/sessions/:sessionId

ì„¸ì…˜ ìˆ˜ì • (SUPER_ADMIN ë˜ëŠ” í•´ë‹¹ STUDY_MANAGER)

#### DELETE /api/sessions/:sessionId

ì„¸ì…˜ ì‚­ì œ (SUPER_ADMIN ì „ìš©)

---

### 5.7 ì¶œì„ (Attendance)

#### GET /api/sessions/:sessionId/attendance

ì¶œì„ ëª©ë¡ ì¡°íšŒ

#### PUT /api/sessions/:sessionId/attendance

ì¶œì„ ì¼ê´„ ìˆ˜ì • (SUPER_ADMIN ë˜ëŠ” í•´ë‹¹ STUDY_MANAGER)

```typescript
// Request
{
  attendance: {
    user_id: UUID;
    status: AttendanceStatus;
    memo?: string;
  }[];
}
```

---

### 5.8 TIL/WIL

#### GET /api/studies/:studyId/til

TIL/WIL ëª©ë¡ ì¡°íšŒ

```typescript
// Query Parameters
{
  page?: number;
  limit?: number;
  author_id?: UUID;
  tag?: string;
  mine?: boolean;  // ë‚´ ê¸€ë§Œ
}

// Response
{
  data: TilPost[];
  pagination: Pagination;
}
```

#### GET /api/til/:postId

TIL/WIL ìƒì„¸ ì¡°íšŒ

#### POST /api/studies/:studyId/til

TIL/WIL ì‘ì„± (ìŠ¤í„°ë”” ì°¸ì—¬ì)

```typescript
// Request
{
  title: string;
  content_md: string;
  tags?: string[];
}
```

#### PATCH /api/til/:postId

TIL/WIL ìˆ˜ì • (ì‘ì„±ì ë³¸ì¸ ë˜ëŠ” SUPER_ADMIN)

#### DELETE /api/til/:postId

TIL/WIL ì‚­ì œ (ì‘ì„±ì ë³¸ì¸ ë˜ëŠ” SUPER_ADMIN)

---

### 5.9 ì•„ì¹´ì´ë¸Œ (Archive)

#### GET /api/studies/:studyId/archive

ì•„ì¹´ì´ë¸Œ ëª©ë¡ ì¡°íšŒ

```typescript
// Query Parameters
{
  category?: ArchiveCategory;
  type?: ArchiveType;
}

// Response
{
  data: Archive[];
}
```

#### POST /api/studies/:studyId/archive/upload

íŒŒì¼ ì—…ë¡œë“œ (SUPER_ADMIN ë˜ëŠ” í•´ë‹¹ STUDY_MANAGER)

```typescript
// Request: multipart/form-data
{
  file: File;
  title: string;
  category: ArchiveCategory; // SLIDE, DOC, CODE, ETC
}
```

#### POST /api/studies/:studyId/archive/link

ë§í¬ ì¶”ê°€ (SUPER_ADMIN ë˜ëŠ” í•´ë‹¹ STUDY_MANAGER)

```typescript
// Request
{
  title: string;
  url: string;
}
```

#### DELETE /api/archive/:archiveId

ì•„ì¹´ì´ë¸Œ ì‚­ì œ (SUPER_ADMIN ì „ìš©)

#### GET /api/archive/:archiveId/download

íŒŒì¼ ë‹¤ìš´ë¡œë“œ

---

### 5.10 íŒ€ (Team)

#### GET /api/team/members

íŒ€ ë©¤ë²„ ëª©ë¡ ì¡°íšŒ

```typescript
// Query Parameters
{
  page?: number;
  limit?: number;
  search?: string;
  role?: UserRole;
  status?: UserStatus;
}

// Response
{
  data: {
    user: User;
    joined_at: Timestamp;
    role: UserRole;
  }[];
  pagination: Pagination;
}
```

#### GET /api/team/members/:memberId

íŒ€ ë©¤ë²„ ìƒì„¸ ì¡°íšŒ

#### GET /api/team/roles

ì—­í•  ì •ì˜ ì¡°íšŒ

```typescript
// Response
{
  data: {
    role: UserRole;
    description: string;
  }
  [];
}
```

---

### 5.11 ê³µì§€ì‚¬í•­ (Notices)

#### GET /api/notices

ê³µì§€ì‚¬í•­ ëª©ë¡ ì¡°íšŒ

```typescript
// Query Parameters
{
  page?: number;
  limit?: number;
  search?: string;
}

// Response
{
  data: Notice[];
  pagination: Pagination;
}
```

#### GET /api/notices/:noticeId

ê³µì§€ì‚¬í•­ ìƒì„¸ ì¡°íšŒ

#### POST /api/notices

ê³µì§€ì‚¬í•­ ì‘ì„± (SUPER_ADMIN ì „ìš©)

```typescript
// Request
{
  title: string;
  content_md: string;
}
```

#### PATCH /api/notices/:noticeId

ê³µì§€ì‚¬í•­ ìˆ˜ì • (SUPER_ADMIN ì „ìš©)

#### DELETE /api/notices/:noticeId

ê³µì§€ì‚¬í•­ ì‚­ì œ (SUPER_ADMIN ì „ìš©)

---

### 5.12 ëŒ€ì‹œë³´ë“œ (Dashboard)

#### GET /api/dashboard

ë©”ì¸ ëŒ€ì‹œë³´ë“œ ë°ì´í„°

```typescript
// Response
{
  my_studies: {
    id: UUID;
    name: string;
    type: StudyType;
    is_manager: boolean;
    member_count: number;
  }[];
  til_stats: {
    total_count: number;
    monthly_count: number;
  };
  recent_activities: ActivityLog[];
  calendar_events: {
    id: UUID;
    title: string;
    date: string;
    type: "session" | "deadline" | "event";
  }[];
}
```

---

### 5.13 ë©”íŠ¸ë¦­ìŠ¤ (Metrics)

#### GET /api/admin/metrics

ê´€ë¦¬ì í†µê³„ (SUPER_ADMIN ì „ìš©)

```typescript
// Response
{
  studies: {
    id: UUID;
    name: string;
    session_count: number;
    member_count: number;
    til_count: number;
  }
  [];
  monthly_til_stats: {
    month: string; // YYYY-MM
    count: number;
  }
  [];
  attendance_stats: {
    study_id: UUID;
    study_name: string;
    present_rate: number;
    late_rate: number;
    absent_rate: number;
  }
  [];
}
```

---

### 5.14 íŒŒì¼ ì—…ë¡œë“œ (Upload)

#### POST /api/upload/profile

í”„ë¡œí•„ ì´ë¯¸ì§€ ì—…ë¡œë“œ

```typescript
// Request: multipart/form-data
{
  file: Image;
}

// Response
{
  url: string;
}
```

---

## 6. ê¶Œí•œ ë§¤íŠ¸ë¦­ìŠ¤

| ê¸°ëŠ¥                      | SUPER_ADMIN | STUDY_MANAGER (í•´ë‹¹ ìŠ¤í„°ë””) | MEMBER (ì°¸ì—¬ì) |
| ------------------------- | :---------: | :-------------------------: | :-------------: |
| **ìœ ì € ê´€ë¦¬**             |
| ìœ ì € ìƒì„±/ë¹„í™œì„±/ê¶Œí•œë³€ê²½ |     âœ…      |             âŒ              |       âŒ        |
| ë¹„ë°€ë²ˆí˜¸ ì´ˆê¸°í™”           |     âœ…      |             âŒ              |       âŒ        |
| **ìŠ¤í„°ë”” ê´€ë¦¬**           |
| ìŠ¤í„°ë”” ìƒì„±/ì‚­ì œ/ìƒíƒœë³€ê²½ |     âœ…      |             âŒ              |       âŒ        |
| ìŠ¤í„°ë”” ë‹´ë‹¹ì ì§€ì •/í•´ì œ   |     âœ…      |             âŒ              |       âŒ        |
| ìŠ¤í„°ë”” ì°¸ì—¬ì ì¶”ê°€/ì œê±°   |     âœ…      |             âŒ              |       âŒ        |
| Overview ìˆ˜ì •             |     âœ…      |             âœ…              |       âŒ        |
| **ì„¸ì…˜ ê´€ë¦¬**             |
| ì„¸ì…˜ ìƒì„±/ìˆ˜ì •            |     âœ…      |             âœ…              |       âŒ        |
| ì„¸ì…˜ ì‚­ì œ                 |     âœ…      |             âŒ              |       âŒ        |
| ì¶œì„ ìˆ˜ì •                 |     âœ…      |             âœ…              |       âŒ        |
| **ì½˜í…ì¸ **                |
| TIL/WIL ì‘ì„±              |     âœ…      |             âœ…              |       âœ…        |
| TIL/WIL ìˆ˜ì •/ì‚­ì œ         |     âœ…      |          âœ… (ì˜µì…˜)          |   âœ… (ë³¸ì¸ë§Œ)   |
| Archive ì—…ë¡œë“œ            |     âœ…      |             âœ…              |       âŒ        |
| Archive ì‚­ì œ              |     âœ…      |             âŒ              |       âŒ        |
| **íŒ€ ê´€ë¦¬**               |
| ê³µì§€ì‚¬í•­ CRUD             |     âœ…      |             âŒ              |       âŒ        |
| ë©”íŠ¸ë¦­ìŠ¤ ì¡°íšŒ             |     âœ…      |             âŒ              |       âŒ        |

---

## 7. ê³µí†µ ê·œê²©

### 7.1 ì‘ë‹µ í˜•ì‹

#### ì„±ê³µ ì‘ë‹µ

```typescript
{
  success: true;
  data?: any;
  message?: string;
}
```

#### ì—ëŸ¬ ì‘ë‹µ

```typescript
{
  success: false;
  error: {
    code: string;      // ì˜ˆ: "UNAUTHORIZED", "FORBIDDEN", "NOT_FOUND"
    message: string;   // ì‚¬ìš©ì ì¹œí™”ì  ë©”ì‹œì§€
    details?: any;     // ì¶”ê°€ ì •ë³´ (ì„ íƒ)
  };
}
```

### 7.2 í˜ì´ì§€ë„¤ì´ì…˜

```typescript
interface Pagination {
  total: number;
  page: number;
  limit: number;
  total_pages: number;
  has_next: boolean;
  has_prev: boolean;
}
```

### 7.3 HTTP ìƒíƒœ ì½”ë“œ

| ì½”ë“œ | ì˜ë¯¸                  | ì‚¬ìš© ìƒí™©                      |
| ---- | --------------------- | ------------------------------ |
| 200  | OK                    | ì„±ê³µì ì¸ ì¡°íšŒ/ìˆ˜ì •             |
| 201  | Created               | ì„±ê³µì ì¸ ìƒì„±                  |
| 204  | No Content            | ì„±ê³µì ì¸ ì‚­ì œ                  |
| 400  | Bad Request           | ì˜ëª»ëœ ìš”ì²­ (ìœ íš¨ì„± ê²€ì¦ ì‹¤íŒ¨) |
| 401  | Unauthorized          | ì¸ì¦ í•„ìš”                      |
| 403  | Forbidden             | ê¶Œí•œ ë¶€ì¡±                      |
| 404  | Not Found             | ë¦¬ì†ŒìŠ¤ ì—†ìŒ                    |
| 409  | Conflict              | ì¤‘ë³µ ë°ì´í„° (ì´ë©”ì¼, í•¸ë“¤ ë“±)  |
| 422  | Unprocessable Entity  | ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì˜¤ë¥˜             |
| 500  | Internal Server Error | ì„œë²„ ì˜¤ë¥˜                      |

### 7.4 ì¸ì¦ í—¤ë”

```
Authorization: Bearer <access_token>
```

### 7.5 Rate Limiting

- ë¡œê·¸ì¸ ì‹¤íŒ¨: 5íšŒ/ë¶„ (ì´í›„ ì¼ì‹œ ì°¨ë‹¨)
- API í˜¸ì¶œ: 100íšŒ/ë¶„ (ì¼ë°˜ ì‚¬ìš©ì)

### 7.6 Activity Log ê¸°ë¡ ëŒ€ìƒ

ëª¨ë“  ì¤‘ìš” ë³€ê²½ì‚¬í•­ì— ëŒ€í•´ activity_logs í…Œì´ë¸”ì— ê¸°ë¡:

- ìœ ì € ìƒì„±/ê¶Œí•œ ë³€ê²½/ë¹„í™œì„±í™”
- ìŠ¤í„°ë”” ìƒì„±/ì‚­ì œ/ìƒíƒœ ë³€ê²½
- ì„¸ì…˜ ìƒì„±/ìˆ˜ì •/ì‚­ì œ
- ì¶œì„ ë³€ê²½
- ê³µì§€ì‚¬í•­ CRUD
- ë¡œê·¸ì¸/ë¡œê·¸ì•„ì›ƒ

---

## ğŸ“ ë³€ê²½ ì´ë ¥

| ë²„ì „ | ë‚ ì§œ       | ë³€ê²½ ë‚´ìš©                                      |
| ---- | ---------- | ---------------------------------------------- |
| v1.0 | 2026-01-24 | ìµœì´ˆ ì‘ì„± (ê¸°ì¡´ ê¸°íšì„œ + í”„ë¡ íŠ¸ì—”ë“œ íƒ€ì… í†µí•©) |
