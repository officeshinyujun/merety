# ğŸ“˜ 404BNF ë‚´ë¶€ í¬í„¸ ê°œë°œ ê¸°íšì„œ v1.1 (ê¶Œí•œ ì¤‘ì‹¬ ì¬ì„¤ê³„)

# 404BNF ë‚´ë¶€ í¬í„¸ ê°œë°œìš© ê¸°íšì„œ v1.0 (í†µí•©ë³¸)

+â€

1. ê·¸ëŸ¼ ìŠ¤í„°ë”” ì°¸ì—¬ìœ¨ê´€ë¦¬ ë©”ë‰´ê°™ì€ ê±° ìˆìœ¼ë©´ ì¢‹ê² ìŠµë‹ˆë‹¤ ã…‹ã…‹ã…‹
   â€

## 0. ëª©ì ê³¼ ë²”ìœ„

### ëª©ì 

- 404BNF íŒ€ ë‚´ë¶€ ìŠ¤í„°ë”” ìš´ì˜ì„ **ë©”ë‰´í˜• í¬í„¸**ì—ì„œ ì²´ê³„ì ìœ¼ë¡œ ê´€ë¦¬
- ìŠ¤í„°ë””ëŠ” **ì´ê´€ë¦¬ì ì¤‘ì‹¬ ìƒì„±/í†µì œ**, ìš´ì˜ì€ **ìŠ¤í„°ë”” ë‹´ë‹¹ìì—ê²Œ ìœ„ì„**
- íŒ€ì›ì€ ìŠ¤í„°ë”” ë‚´ì—ì„œ **TIL/WIL ê¸°ë¡**, ê°œì¸ í™œë™ì€ Dashboardì—ì„œ í™•ì¸

### MVP ë²”ìœ„

- **ì¸ì¦/ê³„ì •(ì˜µì…˜ B)**: ê´€ë¦¬ì ê³„ì • ìƒì„± + ì„ì‹œ ë¹„ë°€ë²ˆí˜¸ + ì²« ë¡œê·¸ì¸ ë¹„ë²ˆ ë³€ê²½ ê°•ì œ
- **ë¡œê·¸ì¸ í•„ìˆ˜(ì „ í˜ì´ì§€ ì ‘ê·¼ ì œì–´)**
- Study(í˜„ì¬ 2ê°œ: Red Team Study / Web Study)
- ìŠ¤í„°ë”” ë‚´ë¶€: Overview / Sessions / Members / TIL / Archive
- Team: Notice / Members / Roles & Contribution
- Admin: User Management / Study Management / Metrics(ìµœì†Œ)

### ì œì™¸(ëª…ì‹œ)

- ëŒ“ê¸€ ì‹œìŠ¤í…œ âŒ
- ì™¸ë¶€ ê³µê°œ í˜ì´ì§€ âŒ
- ê²°ì œ/ìˆ˜ìµí™” ê¸°ëŠ¥ âŒ

---

## 1. ì¸ì¦/ì ‘ê·¼ ì œì–´ ì •ì±…(í•µì‹¬ ìš”êµ¬ì‚¬í•­)

### 1.1 ì „ í˜ì´ì§€ ë¡œê·¸ì¸ í•„ìˆ˜

- **/auth/** ê²½ë¡œ(ë¡œê·¸ì¸/ë¹„ë²ˆë³€ê²½ ë“±)ë§Œ ì˜ˆì™¸
- ê·¸ ì™¸ ëª¨ë“  í˜ì´ì§€ëŠ” ë¯¸ë¡œê·¸ì¸ ì‹œ **/auth/login**ìœ¼ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸
- APIëŠ” ë¯¸ì¸ì¦ ì‹œ **401 Unauthorized**

### 1.2 ì„¸ì…˜/í† í° ì •ì±…(ê¶Œì¥)

- Access Token(ì§§ê²Œ) + Refresh Token(ê¸¸ê²Œ)
- Refresh Tokenì€ ê°€ëŠ¥í•˜ë©´ **httpOnly ì¿ í‚¤**ë¡œ ì €ì¥
- Access Token ë§Œë£Œ ì‹œ ìë™ ê°±ì‹  ë¡œì§

### 1.3 ê³„ì • ìƒíƒœ

- user.status: `active | inactive`
- inactiveëŠ” ë¡œê·¸ì¸ ë¶ˆê°€(403)

### 1.4 ì²« ë¡œê·¸ì¸ ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ ê°•ì œ

- user.must_change_password = true ì¸ ê²½ìš°:
  - ë¡œê·¸ì¸ ì„±ê³µ ì§í›„ **/auth/force-change-password**ë¡œ ê°•ì œ ì´ë™
  - ë³€ê²½ ì™„ë£Œ í›„ must_change_password=false

---

## 2. ì‚¬ìš©ì ì—­í• (Role)ê³¼ ê¶Œí•œ(Authorization)

### 2.1 ì‹œìŠ¤í…œ ì—­í• 

- **SUPER_ADMIN(ì´ê´€ë¦¬ì)**: ì‹œìŠ¤í…œ ì „ì²´ ê´€ë¦¬
- **STUDY_MANAGER(ìŠ¤í„°ë”” ë‹´ë‹¹ì)**: ë‹´ë‹¹ ìŠ¤í„°ë”” ìš´ì˜
- **MEMBER(ì¼ë°˜ íŒ€ì›)**: ì°¸ì—¬ ë° ê¸°ë¡

### 2.2 ìŠ¤í„°ë”” ë‚´ ê´€ê³„(Study Membership Role)

- study_memberships.member_role: `MANAGER | MEMBER`

### 2.3 ê¶Œí•œ ë§¤íŠ¸ë¦­ìŠ¤(ìš”ì•½)

| ê¸°ëŠ¥                      | SUPER_ADMIN | STUDY_MANAGER(í•´ë‹¹ ìŠ¤í„°ë””) | MEMBER(ì°¸ì—¬ì) |
| ------------------------- | ----------- | -------------------------- | -------------- |
| ìœ ì € ìƒì„±/ë¹„í™œì„±/ê¶Œí•œë³€ê²½ | âœ…          | âŒ                         | âŒ             |
| ìŠ¤í„°ë”” ìƒì„±/ì‚­ì œ/ìƒíƒœë³€ê²½ | âœ…          | âŒ                         | âŒ             |
| ìŠ¤í„°ë”” ë‹´ë‹¹ì ì§€ì •/í•´ì œ   | âœ…          | âŒ                         | âŒ             |
| ìŠ¤í„°ë”” ì°¸ì—¬ì ì¶”ê°€/ì œê±°   | âœ…          | âŒ(ì˜µì…˜: ìš”ì²­ë§Œ)           | âŒ             |
| Overview ìˆ˜ì •             | âœ…          | âœ…                         | âŒ             |
| Sessions ìƒì„±/ìˆ˜ì •        | âœ…          | âœ…                         | âŒ             |
| Attendance ìˆ˜ì •           | âœ…          | âœ…                         | âŒ             |
| Archive ì—…ë¡œë“œ            | âœ…          | âœ…                         | âŒ             |
| Archive ì‚­ì œ              | âœ…          | (ì˜µì…˜)                     | âŒ             |
| TIL ì‘ì„±                  | âœ…          | âœ…                         | âœ…             |
| TIL ìˆ˜ì •/ì‚­ì œ             | âœ…          | (ì˜µì…˜: ì‚­ì œ)               | âœ…(ë³¸ì¸ ê¸€)    |

> ìš´ì˜ ì‚¬ê³  ë°©ì§€ë¥¼ ìœ„í•´ ìë£Œ ì‚­ì œëŠ” ê¸°ë³¸ SUPER_ADMINë§Œ ê¶Œì¥ì…ë‹ˆë‹¤.

---

## 3. ë©”ë‰´í˜• ì •ë³´êµ¬ì¡°(IA)

### 3.1 ê¸€ë¡œë²Œ ë„¤ë¹„ê²Œì´ì…˜(ì¢Œì¸¡ ì‚¬ì´ë“œë°”)

- **Dashboard**
- **Study**
  - **Red Team Study**
  - **Web Study**
- **Team**
  - Notice
  - Members
  - Roles & Contribution
- **Admin** _(SUPER_ADMINë§Œ ë…¸ì¶œ)_
  - User Management
  - Study Management
  - Metrics

### 3.2 ìŠ¤í„°ë”” ë‚´ë¶€ íƒ­(ê³µí†µ ê³ ì •)

- Overview
- Sessions
- Members
- TIL / WIL
- Archive

---

## 4. í™”ë©´ ëª…ì„¸(UI/UX)

## 4.1 Auth

### (1) ë¡œê·¸ì¸ (/auth/login)

- ì…ë ¥: email, password
- ì²˜ë¦¬:
  - ì„±ê³µ ì‹œ: must_change_password=true â†’ /auth/force-change-password
  - ì•„ë‹ˆë©´ â†’ /dashboard
- ì‹¤íŒ¨ ë©”ì‹œì§€:
  - ê³„ì • ì—†ìŒ / ë¹„ë°€ë²ˆí˜¸ ì˜¤ë¥˜ / ë¹„í™œì„± ê³„ì •

### (2) ê°•ì œ ë¹„ë²ˆ ë³€ê²½ (/auth/force-change-password)

- ì…ë ¥: current_password(ì˜µì…˜), new_password, confirm
- ê·œì¹™: ìµœì†Œ ê¸¸ì´(ì˜ˆ: 10ì), ë‹¨ìˆœ ì •ì±…ë¶€í„° ì‹œì‘
- ì™„ë£Œ í›„: /dashboard ì´ë™

> ê´€ë¦¬ì ìƒì„± ì„ì‹œ ë¹„ë°€ë²ˆí˜¸ë¡œ ë¡œê·¸ì¸í•˜ëŠ” ì¼€ì´ìŠ¤ì´ë¯€ë¡œ current_passwordëŠ” ì„ íƒì‚¬í•­ìœ¼ë¡œ ë‘¬ë„ ë©ë‹ˆë‹¤(ë³´ì•ˆì •ì±…ì— ë”°ë¼ í•„ìˆ˜ë¡œ í•  ìˆ˜ ìˆìŒ).

---

## 4.2 Dashboard (/dashboard)

- ë‚´ê°€ ì°¸ì—¬ ì¤‘ì¸ ìŠ¤í„°ë”” ì¹´ë“œ(2ê°œ)
  - ë‹´ë‹¹ì ë±ƒì§€ í‘œì‹œ
  - ë°”ë¡œê°€ê¸°: Overview / Sessions / TIL
- ë‚´ TIL í†µê³„:
  - ì „ì²´ ì‘ì„± ìˆ˜, ì´ë²ˆ ë‹¬ ì‘ì„± ìˆ˜
- ìµœê·¼ í™œë™(activity logs) 10ê°œ

---

## 4.3 Study

### (1) Study Home (/study)

- ìŠ¤í„°ë”” 2ê°œ ë¦¬ìŠ¤íŠ¸ + ìƒíƒœ(active/archived)
- í´ë¦­ ì‹œ í•´ë‹¹ ìŠ¤í„°ë”” Overviewë¡œ ì´ë™

### (2) Study Overview (/study/:id/overview)

- ëª©í‘œ/ìš´ì˜ ë°©ì‹/ì»¤ë¦¬í˜ëŸ¼/ê·œì¹™(ë§ˆí¬ë‹¤ìš´)
- ë‹´ë‹¹ì ëª©ë¡ í‘œì‹œ
- í¸ì§‘ ë²„íŠ¼: SUPER_ADMIN ë˜ëŠ” í•´ë‹¹ STUDY_MANAGERë§Œ ë…¸ì¶œ

### (3) Sessions (/study/:id/sessions)

- ì„¸ì…˜ ëª©ë¡ í…Œì´ë¸”: íšŒì°¨/ë‚ ì§œ/ì œëª©/ì‘ì„±ì/ìƒíƒœ
- ì„¸ì…˜ ìƒì„±: ê¶Œí•œìë§Œ
- ì„¸ì…˜ ìƒì„¸:
  - ë‚´ìš©(ë§ˆí¬ë‹¤ìš´), ìë£Œ(ë§í¬/íŒŒì¼), ì¶œì„ ì²´í¬ UI
  - ì¶œì„ ìƒíƒœ: PRESENT/LATE/ABSENT/UNKNOWN

### (4) Members (/study/:id/members)

- ì°¸ì—¬ì ë¦¬ìŠ¤íŠ¸: handle, ì‹œìŠ¤í…œ role, ìŠ¤í„°ë”” ë‚´ role, ì°¸ì—¬ì¼
- ë³€ê²½ ê¶Œí•œ:
  - ì¶”ê°€/ì œê±°/ë‹´ë‹¹ì ì§€ì •: SUPER_ADMINë§Œ

### (5) TIL/WIL (/study/:id/til)

- ëª©ë¡ + í•„í„°(ë‚´ ê¸€, íƒœê·¸, ê¸°ê°„)
- ì‘ì„±(ì°¸ì—¬ìë§Œ)
- ìˆ˜ì •/ì‚­ì œ:
  - ì‘ì„±ì ë³¸ì¸ + SUPER_ADMIN (ì˜µì…˜: ë‹´ë‹¹ìë„ ì‚­ì œ ê°€ëŠ¥)

### (6) Archive (/study/:id/archive)

- ì¹´í…Œê³ ë¦¬: SLIDE/DOC/CODE/LINK/ETC
- ì—…ë¡œë“œ: SUPER_ADMIN + í•´ë‹¹ STUDY_MANAGER
- ì‚­ì œ: ê¸°ë³¸ SUPER_ADMINë§Œ

---

## 4.4 Team

### Notice (/team/notice)

- ê³µì§€ ëª©ë¡/ìƒì„¸
- ì‘ì„±/ìˆ˜ì •/ì‚­ì œ: SUPER_ADMIN

### Members (/team/members)

- íŒ€ì› ëª©ë¡ + ìƒíƒœ(active/inactive) + ì—­í• (role)
- SUPER_ADMINë§Œ ìƒíƒœ/ê¶Œí•œ ê´€ë¦¬ ë§í¬

### Roles & Contribution (/team/contribution)

- ì—­í•  ì •ì˜ ë¬¸ì„œ(ì •ì )
- ê¸°ì—¬ë„ ê°„ë‹¨ í†µê³„(ì¶œì„ ìˆ˜, TIL ìˆ˜)

---

## 4.5 Admin (SUPER_ADMIN ì „ìš©)

### (1) User Management (/admin/users)

- ìœ ì € ìƒì„±(í•µì‹¬)
  - ì…ë ¥: email, handle, name(ì„ íƒ), system role(ê¸°ë³¸ MEMBER)
  - ë™ì‘:
    - ì„ì‹œ ë¹„ë°€ë²ˆí˜¸ ìë™ ìƒì„±(ì˜ˆ: ëœë¤ 12~16ì)
    - must_change_password=true
    - ìƒì„± í›„ â€œì„ì‹œ ë¹„ë°€ë²ˆí˜¸ í‘œì‹œ/ë³µì‚¬â€ (í•œ ë²ˆë§Œ í™•ì¸ ê°€ëŠ¥ ì •ì±… ê¶Œì¥)
- ìœ ì € í¸ì§‘:
  - role ë³€ê²½, status ë³€ê²½(active/inactive)
  - ë¹„ë°€ë²ˆí˜¸ ì´ˆê¸°í™”(ì„ì‹œ ë¹„ë°€ë²ˆí˜¸ ì¬ë°œê¸‰) + must_change_password=true

### (2) Study Management (/admin/studies)

- ìŠ¤í„°ë”” ìƒì„±/ìˆ˜ì •
  - í•„ë“œ: name, type(RED/WEB), slug, status(active/archived)
  - ë‹´ë‹¹ì ì§€ì •(ë³µìˆ˜ ê°€ëŠ¥) â†’ membership MANAGER ìƒì„±
  - ì°¸ì—¬ì ì¶”ê°€/ì œê±°
- ìŠ¤í„°ë”” ì‚­ì œ(ì˜µì…˜: soft delete ê¶Œì¥)

### (3) Metrics (/admin/metrics)

- ìµœì†Œ:
  - ìŠ¤í„°ë””ë³„ ì„¸ì…˜ ìˆ˜
  - ìŠ¤í„°ë””ë³„ TIL ìˆ˜
  - ì›”ë³„ TIL ì‘ì„± ìˆ˜(ìˆ«ì)

---

## 5. ë°ì´í„°ë² ì´ìŠ¤(DB) ì„¤ê³„ (PostgreSQL)

### 5.1 users

- id (uuid, pk)
- email (unique)
- password_hash
- name (nullable)
- handle (unique)
- role (enum: SUPER_ADMIN, STUDY_MANAGER, MEMBER)
- status (enum: active, inactive)
- must_change_password (bool)
- created_at, updated_at, last_login_at

### 5.2 studies

- id (uuid, pk)
- name
- type (enum: RED, WEB)
- slug (unique)
- status (enum: active, archived)
- created_by (user_id)
- created_at, updated_at

### 5.3 study_memberships

- id (uuid, pk)
- study_id (fk)
- user_id (fk)
- member_role (enum: MANAGER, MEMBER)
- joined_at
- unique(study_id, user_id)

### 5.4 study_overview

- study_id (pk, fk)
- content_md (text)
- updated_by (user_id)
- updated_at

### 5.5 sessions

- id (uuid, pk)
- study_id (fk)
- session_no (int)
- title
- scheduled_at (timestamp)
- content_md (text)
- created_by (user_id)
- created_at, updated_at
- unique(study_id, session_no)

### 5.6 attendance

- id (uuid, pk)
- session_id (fk)
- user_id (fk)
- status (enum: PRESENT, LATE, ABSENT, UNKNOWN)
- memo (text, nullable)
- updated_by (user_id)
- updated_at
- unique(session_id, user_id)

### 5.7 til_posts

- id (uuid, pk)
- study_id (fk)
- author_id (fk)
- title
- content_md
- tags (text[] ë˜ëŠ” til_tags ë³„ë„ í…Œì´ë¸”)
- created_at, updated_at
- is_deleted (bool)

### 5.8 archives

- id (uuid, pk)
- study_id (fk)
- uploader_id (fk)
- type (enum: FILE, LINK)
- title
- url ë˜ëŠ” storage_key
- category (enum: SLIDE, DOC, CODE, LINK, ETC)
- created_at
- is_deleted (bool)

### 5.9 notices

- id (uuid, pk)
- title
- content_md
- created_by (user_id)
- created_at, updated_at
- is_deleted (bool)

### 5.10 activity_logs

- id (uuid, pk)
- user_id
- action_type (enum)
- entity_type (enum)
- entity_id (uuid)
- meta (jsonb)
- created_at

---

## 6. API ì„¤ê³„(REST ì´ˆì•ˆ)

### Auth

- POST /api/auth/login
- POST /api/auth/logout
- GET /api/auth/me
- POST /api/auth/change-password _(ê°•ì œ ë³€ê²½ í¬í•¨)_

### Admin - Users

- GET /api/admin/users
- POST /api/admin/users _(ìœ ì € ìƒì„± + ì„ì‹œ ë¹„ë²ˆ ë°˜í™˜ì€ â€œ1íšŒ í‘œì‹œâ€ ì •ì±… ê¶Œì¥)_
- PATCH /api/admin/users/:id _(role/status)_
- POST /api/admin/users/:id/reset-password _(ì„ì‹œ ë¹„ë²ˆ ì¬ë°œê¸‰ + must_change_password=true)_

### Studies

- GET /api/studies _(ë‚´ ì ‘ê·¼ ê°€ëŠ¥ ëª©ë¡)_
- POST /api/studies _(SUPER_ADMIN)_
- PATCH /api/studies/:id _(SUPER_ADMIN)_
- GET /api/studies/:id/members
- POST /api/studies/:id/members _(SUPER_ADMIN)_
- PATCH /api/studies/:id/members/:userId _(SUPER_ADMIN: MANAGER ì§€ì •/í•´ì œ)_

### Overview

- GET /api/studies/:id/overview
- PATCH /api/studies/:id/overview _(ADMIN or í•´ë‹¹ MANAGER)_

### Sessions & Attendance

- GET /api/studies/:id/sessions
- POST /api/studies/:id/sessions _(ADMIN or í•´ë‹¹ MANAGER)_
- GET /api/sessions/:sessionId
- PATCH /api/sessions/:sessionId _(ADMIN or í•´ë‹¹ MANAGER)_
- GET /api/sessions/:sessionId/attendance
- PUT /api/sessions/:sessionId/attendance _(ADMIN or í•´ë‹¹ MANAGER)_

### TIL

- GET /api/studies/:id/til?tag=&author=&mine=
- POST /api/studies/:id/til _(ì°¸ì—¬ì)_
- GET /api/til/:postId
- PATCH /api/til/:postId _(ì‘ì„±ì ë˜ëŠ” ADMIN)_
- DELETE /api/til/:postId _(ì‘ì„±ì ë˜ëŠ” ADMIN)_

### Archive

- GET /api/studies/:id/archive
- POST /api/studies/:id/archive _(ADMIN or í•´ë‹¹ MANAGER)_
- DELETE /api/archive/:id _(ê¸°ë³¸ ADMINë§Œ)_

### Team

- GET /api/notices
- POST /api/notices _(ADMIN)_
- GET /api/team/members

### Metrics

- GET /api/admin/metrics _(ADMIN)_

---

## 7. í•„ìˆ˜ ë³´ì•ˆ ìš”êµ¬ì‚¬í•­(MVP)

- ë¹„ë°€ë²ˆí˜¸ í•´ì‹œ: Argon2 ë˜ëŠ” bcrypt
- ë¡œê·¸ì¸ ì‹¤íŒ¨ rate limit(ê°„ë‹¨ ì ìš©)
- ëª¨ë“  ì¤‘ìš”í•œ ë³€ê²½(ìœ ì € ìƒì„±/ê¶Œí•œ ë³€ê²½/ìŠ¤í„°ë”” ìƒì„±/ì‚­ì œ)ì€ activity_logs ê¸°ë¡
- ì ‘ê·¼ ì œì–´ëŠ” **ì„œë²„(API)ì—ì„œ ìµœì¢… ë³´ì¥** (í”„ë¡ íŠ¸ ê°€ë“œëŠ” UXìš©)

---
